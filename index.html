<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>A-Frame Game</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <style>
        #loading-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 2em;
            z-index: 1000;
        }
        #loading-dots {
            font-size: 3em;
        }
        #restart-button {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="loading-screen">
        <div>Loading<span id="loading-dots">.</span></div>
    </div>

    <a-scene>
        <a-assets>
            <img id="skyTexture" src="https://avatars.mds.yandex.net/i?id=e23c623b063b7641a24f0f40a2e17155806d07cc-10652854-images-thumbs&n=13">
            <img id="groundTexture" src="https://avatars.mds.yandex.net/i?id=047d30662979eadd66c77c93ffe951b6_l-4828361-images-thumbs&n=13">
        </a-assets>

        <a-sky src="#skyTexture"></a-sky>
        <a-plane position="0 0 -5" rotation="-90 0 0" width="20" depth="20" src="#groundTexture" repeat="1 1"></a-plane>
        <a-camera position="0 1.6 -5">
            <a-cursor></a-cursor>
        </a-camera>

        <!-- Объекты для сбора -->
        <a-box position="-2 1.5 -3" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
        <a-sphere position="2 1.5 -3" radius="0.5" color="#EF2D5E" collectible></a-sphere>
        <a-box position="-3 1.5 -4" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
        <a-sphere position="3 1.5 -4" radius="0.5" color="#EF2D5E" collectible></a-sphere>
        <a-box position="-4 1.5 -5" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
        <a-sphere position="4 1.5 -5" radius="0.5" color="#EF2D5E" collectible></a-sphere>
        <a-box position="-5 1.5 -6" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
        <a-sphere position="5 1.5 -6" radius="0.5" color="#EF2D5E" collectible></a-sphere>
        <a-box position="-6 1.5 -7" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
        <a-sphere position="6 1.5 -7" radius="0.5" color="#EF2D5E" collectible></a-sphere>
        <a-box position="-7 1.5 -8" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
        <a-sphere position="7 1.5 -8" radius="0.5" color="#EF2D5E" collectible></a-sphere>

        <!-- Тексты для отображения счета и таймера -->
        <a-text id="score" value="Score: 0" position="-9 2.5 -5" scale="1.5 1.5 1.5"></a-text>
        <a-text id="timer" value="Time: 60" position="9 2.5 -5" scale="1.5 1.5 1.5"></a-text>
        <a-text id="end-message" value="Game Over!" position="0 1.5 -5" scale="2 2 2" visible="false"></a-text>
        <a-text id="final-score" value="Final Score: 0" position="0 0.5 -5" scale="1.5 1.5 1.5" visible="false"></a-text>
        <a-plane id="restart-button" position="0 -1 -5" rotation="0 0 0" width="2" height="0.5" color="#4CC3D9" visible="false">
            <a-text value="Restart" position="0 0.25 0" scale="1 1 1" color="#000"></a-text>
        </a-plane>
    </a-scene>

    <script>
        AFRAME.registerComponent('collectible', {
            init: function () {
                const el = this.el;
                el.addEventListener('click', function () {
                    el.parentNode.removeChild(el);
                    document.getElementById('score').setAttribute('text', 'value: Score: ' + (++document.score));
                });
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            document.score = 0;
            let timeLeft = 60; // 60 seconds
            document.timer = setInterval(function () {
                document.getElementById('timer').setAttribute('text', 'value: Time: ' + timeLeft);
                if (--timeLeft < 0) {
                    clearInterval(document.timer);
                    endGame();
                }
            }, 1000);

            document.getElementById('restart-button').addEventListener('click', function () {
                restartGame();
            });

            // Анимация загрузки
            let dotsCount = 1;
            setInterval(function () {
                const dots = document.getElementById('loading-dots');
                if (dotsCount > 3) {
                    dotsCount = 1;
                    dots.textContent = '.';
                } else {
                    dotsCount++;
                    dots.textContent += '.';
                }
            }, 500);

            // Удаление экрана загрузки после загрузки сцены
            const scene = document.querySelector('a-scene');
            scene.addEventListener('loaded', function () {
                document.getElementById('loading-screen').style.display = 'none';
            });
        });

        function endGame() {
            document.getElementById('end-message').setAttribute('visible', 'true');
            document.getElementById('final-score').setAttribute('text', 'value: Final Score: ' + document.score);
            document.getElementById('restart-button').setAttribute('visible', 'true');
        }

        function restartGame() {
            document.score = 0;
            document.getElementById('score').setAttribute('text', 'value: Score: 0');
            document.getElementById('timer').setAttribute('text', 'value: Time: 60');
            document.getElementById('end-message').setAttribute('visible', 'false');
            document.getElementById('final-score').setAttribute('visible', 'false');
            document.getElementById('restart-button').setAttribute('visible', 'false');

            // Перезагрузка объектов для сбора
            const scene = document.querySelector('a-scene');
            scene.innerHTML += `
                <a-box position="-2 1.5 -3" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
                <a-sphere position="2 1.5 -3" radius="0.5" color="#EF2D5E" collectible></a-sphere>
                <a-box position="-3 1.5 -4" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
                <a-sphere position="3 1.5 -4" radius="0.5" color="#EF2D5E" collectible></a-sphere>
                <a-box position="-4 1.5 -5" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
                <a-sphere position="4 1.5 -5" radius="0.5" color="#EF2D5E" collectible></a-sphere>
                <a-box position="-5 1.5 -6" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
                <a-sphere position="5 1.5 -6" radius="0.5" color="#EF2D5E" collectible></a-sphere>
                <a-box position="-6 1.5 -7" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
                <a-sphere position="6 1.5 -7" radius="0.5" color="#EF2D5E" collectible></a-sphere>
                <a-box position="-7 1.5 -8" rotation="0 45 0" color="#4CC3D9" depth="0.5" height="0.5" width="0.5" collectible></a-box>
                <a-sphere position="7 1.5 -8" radius="0.5" color="#EF2D5E" collectible></a-sphere>
            `;

            let timeLeft = 60;
            document.timer = setInterval(function () {
                document.getElementById('timer').setAttribute('text', 'value: Time: ' + timeLeft);
                if (--timeLeft < 0) {
                    clearInterval(document.timer);
                    endGame();
                }
            }, 1000);
        }
    </script>
</body>
</html>